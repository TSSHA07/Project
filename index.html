<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title> AURA </title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <style>
    body { background-color: #2f3136; color: white; font-family: Arial, sans-serif; }
    .chat-container { display: flex; height: 100vh; }
    .sidebar { width: 300px; background: #36393f; padding: 20px; overflow-y: auto; }
    .main-chat { flex: 1; display: flex; flex-direction: column; }
    .messages { flex: 1; padding: 20px; overflow-y: auto; }
    .message-input { display: flex; padding: 10px; background: #40444b; }
    .message-input input { flex: 1; padding: 10px; border-radius: 5px; border: none; margin-right: 10px; }
    .message-input button { padding: 10px 20px; border: none; border-radius: 5px; background: #5865f2; color: white; cursor: pointer; }
    .news { margin-top: 20px; }
    .news h3 { font-weight: bold; margin-bottom: 10px; }
    .news-item { margin-bottom: 10px; font-size: 14px; color: #ccc; cursor: pointer; }
    .news-item:hover { color: #fff; }
  </style>
</head>
<body>
  <div class="chat-container">
    <!-- Sidebar -->
    <div class="sidebar">
      <h2 class="text-xl font-bold mb-4">Hello, <span id="userName"></span></h2>

      <!-- Example Channels -->
      <div class="mb-6">
        <p class="font-bold mb-2">Channels</p>
        <div># general</div>
        <div># random</div>
      </div>

      <!-- News / Trending -->
      <div class="news">
        <h3>News</h3>
        <div class="news-item">Breaking: New Tech Released</div>
        <div class="news-item">Market Updates Today</div>
        <div class="news-item">Sports Highlights</div>

        <h3 class="mt-4">Trending</h3>
        <div class="news-item">#WebDevelopment</div>
        <div class="news-item">#Gaming</div>
        <div class="news-item">#AI</div>
      </div>
    </div>

    <!-- Main Chat -->
    <div class="main-chat">
      <div class="messages" id="messages">
        <!-- Chat messages will appear here -->
      </div>

      <div class="message-input">
        <input type="text" id="messageInput" placeholder="Type your message...">
        <button onclick="sendMessage()">Send</button>
      </div>
    </div>
  </div>

  <!-- Firebase SDKs -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-app.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-auth.js";
    import { getDatabase, ref, push, onChildAdded } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-database.js";

    // ✅ Firebase Config
    const firebaseConfig = {
      apiKey: "AIzaSyAF78wb9_OSrfPc93iaFmmNN-CZY03sJMQ",
      authDomain: "project-java0001.firebaseapp.com",
      databaseURL: "https://project-java0001-default-rtdb.firebaseio.com",
      projectId: "project-java0001",
      storageBucket: "project-java0001.appspot.com",
      messagingSenderId: "246764397103",
      appId: "1:246764397103:web:ae0c23a62b60ee124adcda"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getDatabase(app);

    let currentUser = null;

    // ✅ Check if user is logged in
    onAuthStateChanged(auth, (user) => {
      if (user) {
        currentUser = user;
        document.getElementById("userName").textContent = user.email;
        loadMessages();
      } else {
        // redirect to login if not signed in
        window.location.href = "login.html";
      }
    });

    // ✅ Send message
    function sendMessage() {
      const msgInput = document.getElementById("messageInput");
      const text = msgInput.value.trim();
      if (text === "" || !currentUser) return;

      push(ref(db, "messages"), {
        sender: currentUser.email,
        text: text,
        timestamp: Date.now()
      });

      msgInput.value = "";
    }

    // ✅ Load messages
    function loadMessages() {
      const messagesRef = ref(db, "messages");
      const messagesDiv = document.getElementById("messages");
      messagesDiv.innerHTML = ""; // clear existing messages

      onChildAdded(messagesRef, (data) => {
        const msg = data.val();
        const div = document.createElement("div");
        div.innerHTML = `<strong>${msg.sender}:</strong> ${msg.text}`;
        messagesDiv.appendChild(div);
        messagesDiv.scrollTop = messagesDiv.scrollHeight;
      });
    }
  </script>
</body>
</html>

